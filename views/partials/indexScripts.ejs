<script type="module">
  import * as myModule from "/scripts/index.js";

  myModule.setUpMap(
    JSON.parse(
      "<%= JSON.stringify(items.map((item) => [item.location.x, item.location.y])) %>"
    )
  );
</script>

<% items.forEach((item) => { %>
<script type="module">
  import * as myModule from "/scripts/index.js";

  myModule.popups.push(
    L.marker([
      Number("<%= item.location.x %>"),
      Number("<%= item.location.y %>"),
    ])
      .addTo(myModule.map)
      .bindPopup(`<%- include('./item', { item }) %>`)
  );
</script>
<% }); %>

<script type="module">
  import * as myModule from "/scripts/index.js";
  myModule.openPopup();
</script>
